[{"path":"/articles/basics.html","id":"dgp","dir":"Articles","previous_headings":"","what":"DGP","title":"sp2DID","text":"\\(N=200\\) \\(p=100\\) dimension control variables, \\(X_{} \\sim N\\left(0, I_{p \\times p}\\right)\\). Let \\(\\gamma_{0}=(1,1 / 2,1 / 3,1 / 4\\), \\(1 / 5,0, \\ldots, 0) \\\\mathbb{R}^{p}\\), \\(D_{}\\) generated propensity score \\(e := P(D=1 \\mid X)=\\frac{1}{1+\\exp \\left(-X^{\\prime} \\gamma_{0}\\right)}\\). pscore sparse. Also, let potential outcomes \\(Y_{}^{0}(0)=X_{}^{\\prime} \\beta_{0}+\\varepsilon_{1}, Y_{}^{0}(1)=Y_{}^{0}(0)+1+ \\rho e + \\varepsilon_{2}\\), \\(Y_{}^{1}(1)=\\) \\(\\theta_{0}+Y_{}^{0}(1)+\\varepsilon_{3}\\), \\(\\beta_{0}=\\gamma_{0}+0.5\\) \\(\\theta_{0}=3\\), error terms follow \\(N(0,0.1)\\). Since \\(e\\) enters process untreated potential outcome 2nd period \\(Y_{}^{0}(1)\\), parallel trends assumption violated whenever \\(\\rho \\neq 0\\). Researchers observe \\(\\left\\{Y_{}(0), Y_{}(1), D_{}, X_{}\\right\\}\\) \\(=1, \\ldots, N\\), \\(Y_{}(0)=Y_{}^{0}(0)\\) \\(Y_{}(1)=\\) \\(Y_{}^{0}(1)\\left(1-D_{}\\right)+Y_{}^{1}\\) (1) \\(D_{}\\).","code":"# %% # DGP simdgp = \\(N = 200,   p = 100, s = 5, # covariate dimension and signal strength   theta = 3, # true effect   ρ = 0 # no parallel trends violation by default ){   # sparse signal in pscore   γ = c(s:1, rep(0, (p - s))) / s   X = array(rnorm(N * p), dim = c(N, p))   e = expit(X %*% γ)   D = rbinom(N, 1, e)   beta1 = γ + 0.5   ε1 = rnorm(N, 0, 0.1); ε2 = ε3 = ε1   # potential outcomes   Y10 = Y11 = Y01 = Y00 = rep(NA, N)   Y00 = X %*% beta1 + ε1   Y10 = Y01 = Y00 + 1 + ρ * e + ε2 # pscore enters outcome model   Y11 = theta + Y01 + ε3   # outcomes at two time periods   Y0 = Y00   Y1 = Y01 * (1 - D) + Y11 * D   data.frame(Y1, Y0, D, X) }  estDIDs = \\(...){   df = simdgp(...)   res = c(     # naive difference in post     naive = with(df, mean(Y1[D == 1]) - mean(Y1[D == 0])),     # diff in diff     did = DID(df$D, df$Y1, df$Y0),     # outcome modeling     om = omDID(df[, -(1:3)] |> as.matrix(), df$D, df$Y1, df$Y0, xfit = F),     # outcome modeling XF     omXF = omDID(df[, -(1:3)] |> as.matrix(), df$D, df$Y1, df$Y0, xfit = T),     # IPW     ipw = ipwDID(df[, -(1:3)] |> as.matrix(), df$D, df$Y1, df$Y0, xfit = F),     # IPW XF     ipwXF = ipwDID(df[, -(1:3)] |> as.matrix(), df$D, df$Y1, df$Y0, xfit = T),     # aIPW     aipw = aipwDID(df[, -(1:3)] |> as.matrix(), df$D, df$Y1, df$Y0, xfit = F),     # aIPW     aipwXF = aipwDID(df[, -(1:3)] |> as.matrix(), df$D, df$Y1, df$Y0, xfit = T)   )   return(res) } # trial run estDIDs() ##    naive      did       om     omXF      ipw    ipwXF     aipw   aipwXF  ## 5.931734 3.000713 3.008693 2.717237 3.160076 3.031915 2.982465 2.981989 # sampling distribution plotter distPlot = \\(x, t, lb = 2.5, ub = 3.5, trueval = 3){   hist(x, breaks = 100, main = t, xlab = \"\", ylab = \"\", yaxt = \"n\", xlim = c(lb, ub))   abline(v = mean(x), col = 'blue'); abline(v = trueval, col = 'red') }"},{"path":"/articles/basics.html","id":"unconditional-parallel-trends-rho-0","dir":"Articles","previous_headings":"","what":"unconditional parallel trends (\\(\\rho = 0\\))","title":"sp2DID","text":"Difference differences clearly unbiased low MSE, AIPW. IPW small bias fit using sample splitting, large bias otherwise.","code":"B = 1000 tic() ests = mcReplicate(B, estDIDs(), mc.cores = 15) toc() ## 412.148 sec elapsed par(mfrow = c(4, 2), mar = c(5, 0, 4, 0)) distPlot(ests[1, ], \"naive\") distPlot(ests[2, ], \"did\") distPlot(ests[3, ], \"om\") distPlot(ests[4, ], \"omXF\") distPlot(ests[5, ], \"ipw\") distPlot(ests[6, ], \"ipwXF\") distPlot(ests[7, ], \"aipw\") distPlot(ests[8, ], \"aipwXF\")"},{"path":"/articles/basics.html","id":"conditional-parallel-trends-rho-2","dir":"Articles","previous_headings":"","what":"conditional parallel trends (\\(\\rho = 2\\))","title":"sp2DID","text":"Now, Difference differences clearly biased. IPW smaller bias fit using sample splitting, still quite biased. AIPW still unbiased low MSE.","code":"B = 1000 tic() ests2 = mcReplicate(B, estDIDs(ρ = 2), mc.cores = 15) toc() ## 394.389 sec elapsed par(mfrow = c(4, 2), mar = c(5, 0, 4, 0)) distPlot(ests2[1, ], \"naive\", lb = 2, ub = 4) distPlot(ests2[2, ], \"did\", lb = 2, ub = 4) distPlot(ests2[3, ], \"om\", lb = 2, ub = 4) distPlot(ests2[4, ], \"omXF\", lb = 2, ub = 4) distPlot(ests2[5, ], \"ipw\", lb = 2, ub = 4) distPlot(ests2[6, ], \"ipwXF\", lb = 2, ub = 4) distPlot(ests2[7, ], \"aipw\", lb = 2, ub = 4) distPlot(ests2[8, ], \"aipwXF\", lb = 2, ub = 4)"},{"path":"/articles/basics.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"sp2DID","text":"Abadie, . (2005): “Semiparametric Difference--Differences Estimators,” Review economic studies, 72, 1–19. Chang, Neng-Chieh (2020): “Double/debiased machine learning difference--differences models.” Econometrics Journal , 177-191.","code":""},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Apoorva Lal. Author, maintainer.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Lal (2022). sp2DID: sp2DID:Semiparametric two-period difference differences. R package version 0.0.0.666.","code":"@Manual{,   title = {sp2DID: sp2DID:Semiparametric two-period difference in differences},   author = {Apoorva Lal},   year = {2022},   note = {R package version 0.0.0.666}, }"},{"path":"/index.html","id":"sp2did","dir":"","previous_headings":"","what":"sp2DID:Semiparametric two-period difference in differences","title":"sp2DID:Semiparametric two-period difference in differences","text":"Difference--differences estimation using Abadie (2005) Chang (2020) IPW AIPW estimators. Nuisance functions fit using regularized regression (glmnet). Installation","code":"devtools::install_github(\"apoorvalal/sp2DID\")"},{"path":"/reference/DID.html","id":null,"dir":"Reference","previous_headings":"","what":"Vanilla Difference in Differences estimation — DID","title":"Vanilla Difference in Differences estimation — DID","text":"Vanilla Difference Differences estimation","code":""},{"path":"/reference/DID.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Vanilla Difference in Differences estimation — DID","text":"","code":"DID(D, Y1, Y0)"},{"path":"/reference/DID.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Vanilla Difference in Differences estimation — DID","text":"D N-vector treatment assignments (treatment applies period 2) Y1 N-vector outcomes second period Y0 N-vector outcomes first period","code":""},{"path":"/reference/DID.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Vanilla Difference in Differences estimation — DID","text":"ATT estimate","code":""},{"path":"/reference/DID.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Vanilla Difference in Differences estimation — DID","text":"Ashenfelter (1977), Snow(18xx)","code":""},{"path":"/reference/aipwDID.html","id":null,"dir":"Reference","previous_headings":"","what":"Chang (2020) Double-Robust semiparametric difference in differences\nestimator for the ATT fit using LASSO — aipwDID","title":"Chang (2020) Double-Robust semiparametric difference in differences\nestimator for the ATT fit using LASSO — aipwDID","text":"Chang (2020) Double-Robust semiparametric difference differences estimator ATT fit using LASSO","code":""},{"path":"/reference/aipwDID.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Chang (2020) Double-Robust semiparametric difference in differences\nestimator for the ATT fit using LASSO — aipwDID","text":"","code":"aipwDID(X, D, Y1, Y0, xfit = TRUE)"},{"path":"/reference/aipwDID.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Chang (2020) Double-Robust semiparametric difference in differences\nestimator for the ATT fit using LASSO — aipwDID","text":"X NxK matrix covariates propensity score D N-vector treatment assignments (treatment applies period 2) Y1 N-vector outcomes second period Y0 N-vector outcomes first period","code":""},{"path":"/reference/aipwDID.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Chang (2020) Double-Robust semiparametric difference in differences\nestimator for the ATT fit using LASSO — aipwDID","text":"ATT estimate","code":""},{"path":"/reference/aipwDID.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Chang (2020) Double-Robust semiparametric difference in differences\nestimator for the ATT fit using LASSO — aipwDID","text":"Chang(2020), Zhao Sant'Anna (2021)","code":""},{"path":"/reference/ipwDID.html","id":null,"dir":"Reference","previous_headings":"","what":"Abadie (2005) semiparametric difference in differences estimator for the\nATT fit using LASSO — ipwDID","title":"Abadie (2005) semiparametric difference in differences estimator for the\nATT fit using LASSO — ipwDID","text":"Abadie (2005) semiparametric difference differences estimator ATT fit using LASSO","code":""},{"path":"/reference/ipwDID.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Abadie (2005) semiparametric difference in differences estimator for the\nATT fit using LASSO — ipwDID","text":"","code":"ipwDID(X, D, Y1, Y0, xfit = TRUE)"},{"path":"/reference/ipwDID.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Abadie (2005) semiparametric difference in differences estimator for the\nATT fit using LASSO — ipwDID","text":"X NxK matrix covariates propensity score D N-vector treatment assignments (treatment applies period 2) Y1 N-vector outcomes second period Y0 N-vector outcomes first period","code":""},{"path":"/reference/ipwDID.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Abadie (2005) semiparametric difference in differences estimator for the\nATT fit using LASSO — ipwDID","text":"ATT estimate","code":""},{"path":"/reference/ipwDID.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Abadie (2005) semiparametric difference in differences estimator for the\nATT fit using LASSO — ipwDID","text":"Abadie(2005)","code":""},{"path":"/reference/omDID.html","id":null,"dir":"Reference","previous_headings":"","what":"outcome model for the ATT fit using LASSO — omDID","title":"outcome model for the ATT fit using LASSO — omDID","text":"outcome model ATT fit using LASSO","code":""},{"path":"/reference/omDID.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"outcome model for the ATT fit using LASSO — omDID","text":"","code":"omDID(X, D, Y1, Y0, xfit = TRUE)"},{"path":"/reference/omDID.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"outcome model for the ATT fit using LASSO — omDID","text":"X NxK matrix covariates propensity score D N-vector treatment assignments (treatment applies period 2) Y1 N-vector outcomes second period Y0 N-vector outcomes first period","code":""},{"path":"/reference/omDID.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"outcome model for the ATT fit using LASSO — omDID","text":"ATT estimate","code":""},{"path":"/reference/omDID.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"outcome model for the ATT fit using LASSO — omDID","text":"Heckman et al (1997), Abadie(2005)","code":""}]
